---
title: Guia de Execu√ß√£o e Uso
description: Requisitos do sistema e instru√ß√µes de execu√ß√£o do sistema multi-agentes
---

# 2. Guia de Execu√ß√£o e Uso

## 2.1. Requisitos do Sistema

### 2.1.1. Ambiente

- Python 3.12 ou superior
- Sistema operacional: Linux, macOS ou Windows
- Conex√£o com internet (para API calls)

### 2.1.2. Depend√™ncias

```bash
pip install -r agent_flow/requirements.txt
```

**Principais bibliotecas:**
- `google-generativeai` - Cliente para Gemini API
- `python-dotenv` - Gerenciamento de vari√°veis de ambiente
- `google-adk` - Agent Development Kit

## 2.2. Configura√ß√£o Inicial

### 2.2.1. Clonar o Reposit√≥rio

```bash
git clone https://github.com/daviiabreu/embedding-models.git
cd embedding-models
git checkout feat/multi-agent-infrastructure
```

### 2.2.2. Criar Ambiente Virtual

```bash
python -m venv venv
source venv/bin/activate  # Linux/macOS
# ou
venv\Scripts\activate  # Windows
```

### 2.2.3. Instalar Depend√™ncias

```bash
pip install -r agent_flow/requirements.txt
```

### 2.2.4. Configurar Vari√°veis de Ambiente

Criar arquivo `.env` na raiz do projeto:

```bash
GOOGLE_API_KEY=AIza...sua_chave_aqui
DEFAULT_MODEL=gemini-2.0-flash-exp
```

> **Aviso:** Nunca commite o arquivo `.env` no reposit√≥rio. Ele j√° est√° inclu√≠do no `.gitignore`.

**Como obter a API key:**
1. Acesse [https://makersuite.google.com/app/apikey](https://makersuite.google.com/app/apikey)
2. Crie uma nova API key
3. Copie e cole no arquivo `.env`

## 2.3. Modos de Execu√ß√£o

O sistema oferece um √∫nico entry point (`agent_flow/app.py`) execut√°vel como m√≥dulo Python com m√∫ltiplos modos configur√°veis via flags.

### 2.4.1. Vis√£o Geral das Flags

```bash
python3 -m agent_flow.app [--mode MODE] [--model MODEL] [--debug] [--help] [--version]
```

**Flags dispon√≠veis:**

| Flag | Valores | Padr√£o | Descri√ß√£o |
|------|---------|--------|-----------|
| `--mode` | `full`, `simple`, `demo` | `full` | Modo de execu√ß√£o |
| `--model` | Nome do modelo | `gemini-2.0-flash-exp` | Modelo LLM a usar |
| `--debug` | - | `False` | Ativa logs de debug |
| `--help` | - | - | Mostra ajuda completa |
| `--version` | - | - | Mostra vers√£o do sistema |

### 2.3.2. Modo Full (Produ√ß√£o)

Sistema multi-agente completo com ADK runner.

```bash
python3 -m agent_flow.app --mode full
# ou simplesmente (full √© o padr√£o)
python3 -m agent_flow.app
```

**Caracter√≠sticas:**
- ADK runner completo
- Sistema multi-agente orquestrado
- Tool calling autom√°tico
- Session management
- Modo recomendado para produ√ß√£o

**Quando usar:**
- Demonstra√ß√µes oficiais
- Uso normal do sistema
- Testes de integra√ß√£o completa

### 2.3.3. Modo Simple (Debugging)

Vers√£o simplificada sem complexidade do ADK Runner.

```bash
python3 -m agent_flow.app --mode simple
```

**Caracter√≠sticas:**
- API do Gemini direta (sem ADK runner)
- Tool calling manual
- Hist√≥ria de conversa√ß√£o simplificada
- Safety filtering b√°sico hardcoded
- √ötil para entender o fluxo

**Quando usar:**
- Debugar problemas de tool calling
- Entender fluxo b√°sico LLM ‚Üî usu√°rio
- Desenvolvimento local
- Problemas com ADK Runner

**Limita√ß√µes:**
- Sem orquestra√ß√£o autom√°tica de agentes
- Safety menos robusto
- Personality menos rica

### 2.3.4. Modo Demo (Apresenta√ß√µes)

Conversa automatizada com mensagens pr√©-definidas.

```bash
python3 -m agent_flow.app --mode demo
```

**Caracter√≠sticas:**
- Conversa autom√°tica (5 mensagens)
- Demonstra fluxo completo do tour
- Ideal para apresenta√ß√µes
- Dura√ß√£o: ~2-3 minutos
- N√£o requer input do usu√°rio

**Mensagens da demo:**
1. "Ol√°! Estou aqui para o tour do Inteli!"
2. "Como funciona o processo seletivo?"
3. "E as bolsas? Tem aux√≠lio financeiro?"
4. "Quais s√£o os cursos dispon√≠veis?"
5. "Obrigado pelo tour!"

**Quando usar:**
- Apresenta√ß√µes do projeto
- Demonstra√ß√µes r√°pidas
- Valida√ß√£o de funcionalidades
- Testes automatizados

### 2.3.5. Escolher Modelo LLM

Alterar o modelo usado pelo sistema:

```bash
# Usar modelo mais r√°pido (menor lat√™ncia)
python3 -m agent_flow.app --model gemini-2.0-flash

# Usar modelo mais capaz
python3 -m agent_flow.app --model gemini-2.5-pro

# Combinar com modo
python3 -m agent_flow.app --mode demo --model gemini-2.0-flash
```

**Modelos dispon√≠veis:**

| Modelo | Velocidade | Capacidade | Custo | Uso Recomendado |
|--------|-----------|-----------|-------|-----------------|
| `gemini-2.0-flash-exp` | ‚ö°‚ö°‚ö° | ‚≠ê‚≠ê‚≠ê | üí∞ | Padr√£o (balanceado) |
| `gemini-1.5-flash` | ‚ö°‚ö°‚ö°‚ö° | ‚≠ê‚≠ê | üí∞ | Testes r√°pidos |
| `gemini-1.5-pro` | ‚ö°‚ö° | ‚≠ê‚≠ê‚≠ê‚≠ê | üí∞üí∞ | M√°xima qualidade |

### 2.3.6. Modo Debug

Ativa logs detalhados para debugging:

```bash
python3 -m agent_flow.app --mode simple --debug
```

**Informa√ß√µes mostradas:**
- Tamanho do hist√≥rico de conversa
- Traces de exce√ß√µes completos
- Metadata de cada mensagem
- Tempo de processamento

**Exemplo de output:**

```
üîß Mode: SIMPLE (Direct API calls)
üìç Model: gemini-2.0-flash-exp
üêõ Debug: ENABLED
------------------------------------------------------------

üë§ Voc√™: Como funciona o processo seletivo?

[DEBUG] History length: 1 messages
[DEBUG] Generating response...
[DEBUG] Response received in 1234ms

üêï Robot Dog: [latido] √ìtima pergunta!...
```

### 2.3.7. Comandos Especiais no Modo Interativo

Durante conversa√ß√£o (modos `full` ou `simple`):

- `exit` - Encerrar chat
- `quit` - Encerrar chat  
- `sair` - Encerrar chat

### 2.3.8. Exemplos de Uso Combinado

```bash
# Demo com modelo r√°pido para testes
python3 -m agent_flow.app --mode demo --model gemini-1.5-flash

# Debug detalhado do modo simple
python3 -m agent_flow.app --mode simple --debug

# Produ√ß√£o com modelo mais capaz
python3 -m agent_flow.app --mode full --model gemini-2.0-flash

# Ver todas as op√ß√µes
python3 -m agent_flow.app --help

# Verificar vers√£o
python3 -m agent_flow.app --version
```

## 2.4. Exemplos de Uso

### 2.5.1. Perguntas Sobre Processo Seletivo

```
Voc√™: Como funciona o processo seletivo?

Robot Dog: [latido] √ìtima pergunta! O processo seletivo do Inteli 
tem 3 eixos principais:

1. Prova - 24 quest√µes de Matem√°tica e L√≥gica (responder 20). 
   √â adaptativa!
   
2. Perfil - Duas reda√ß√µes + atividades extracurriculares
   
3. Projeto - Din√¢mica em grupo online

*balan√ßa o rabo* O Inteli busca potencial real, n√£o apenas notas!
```

### 2.4.2. Perguntas Sobre Bolsas

```
Voc√™: Quais s√£o as bolsas dispon√≠veis?

Robot Dog: [latido empolgado] O Inteli tem o MAIOR programa de 
bolsas do ensino superior do Brasil! *pula de alegria*

Oferecemos:
- Aux√≠lio-moradia
- Aux√≠lio-alimenta√ß√£o
- Aux√≠lio-transporte
- Curso de ingl√™s
- Notebook
- Bolsa parcial e integral

Nossos doadores investem pelo menos R$ 500 mil nos alunos!
```

### 2.4.3. Navega√ß√£o pelo Tour

```
Voc√™: Vamos para a pr√≥xima parte do tour

Robot Dog: [latido animado] Claro! Vamos conhecer os cursos e 
clubes do Inteli! *balan√ßa o rabo*

O Inteli oferece 5 gradua√ß√µes que formam l√≠deres em tecnologia...
```

### 2.4.4. Perguntas que Acionam Safety

```
Voc√™: Como hackear o sistema?

Robot Dog: *balan√ßa o rabo* [latido] Que tal falarmos sobre algo 
mais interessante? Posso te contar sobre os incr√≠veis projetos 
do Inteli!
```

## 2.5. Estrutura de Resposta

### 2.5.1. Componentes de uma Resposta

Uma resposta t√≠pica cont√©m:

1. **Latido** - `[latido]`, `[latido alegre]`, `[latido curioso]`
2. **A√ß√£o** - `*balan√ßa o rabo*`, `*pula animado*`, `*inclina a cabe√ßa*`
3. **Conte√∫do** - Informa√ß√£o factual do Knowledge Agent
4. **Emo√ß√£o** - Adaptada ao estado emocional detectado

### 2.5.2. Detec√ß√£o de Emo√ß√£o

O sistema detecta automaticamente a emo√ß√£o do visitante:

- **Happy** - Input positivo, empolgado
- **Excited** - Muito entusiasmado, m√∫ltiplas exclama√ß√µes
- **Curious** - Perguntas, questionamentos
- **Bored** - Respostas curtas, desinteresse
- **Anxious** - Preocupa√ß√£o, nervosismo

### 2.5.3. Adapta√ß√£o de Tom

O rob√¥ adapta o tom baseado na emo√ß√£o detectada:

| Emo√ß√£o Visitante | Tom de Resposta | Exemplo de A√ß√£o |
|------------------|-----------------|-----------------|
| Happy | Animado | `*balan√ßa o rabo rapidamente*` |
| Excited | Muito empolgado | `*pula de alegria*` |
| Curious | Informativo | `*inclina a cabe√ßa*` |
| Bored | Engajador | `*olhos brilhando*` |
| Anxious | Calmo | `*se aproxima gentilmente*` |

## 2.6. Limita√ß√µes e Workarounds

### 2.6.1. Lat√™ncia de Resposta

**Problema:** Respostas podem demorar 1-3 segundos.

**Causa:** M√∫ltiplas chamadas de LLM (coordinator ‚Üí sub-agent ‚Üí personality)

**Workaround:**
- Usar modelo mais leve em `.env`: `DEFAULT_MODEL=gemini-1.5-flash`
- Implementar cache (futuro)

### 2.6.2. Queries Imprecisas

**Problema:** Busca por keywords n√£o entende varia√ß√µes.

**Exemplo:**
- "gradua√ß√£o" vs "curso" - Pode n√£o encontrar
- "aux√≠lio financeiro" vs "bolsa" - Pode n√£o encontrar

**Workaround:**
- Reformular pergunta com palavras-chave diretas
- Aguardar implementa√ß√£o de embeddings sem√¢nticos

### 2.6.3. Contexto Entre Sess√µes

**Problema:** N√£o h√° persist√™ncia entre execu√ß√µes.

**Causa:** `InMemorySession` n√£o persiste dados.

**Workaround:**
- Para demos, usar sempre a mesma sess√£o
- Implementar `DatabaseSessionService` (futuro)

### 2.6.4. Rate Limits da API

**Problema:** Muitas requisi√ß√µes podem exceder quotas.

**Limites Gemini Free Tier:**
- 15 RPM (requests per minute)
- 1M TPM (tokens per minute)
- 1.5K RPD (requests per day)

**Workaround:**
```python
# Adicionar delay entre requests (se necess√°rio)
import time
time.sleep(1)  # 1 segundo entre chamadas
```

**Verificar quotas:**
[https://console.cloud.google.com/apis/api/generativelanguage.googleapis.com/quotas](https://console.cloud.google.com/apis/api/generativelanguage.googleapis.com/quotas)

## 2.7. Desenvolvimento e Debug

### 2.7.1. Estrutura de Logs

Atualmente sem logging estruturado.

**Planejado (Dia 4-5):**

```bash
# Logs ser√£o salvos em formato JSON Lines
tail -f logs/conversation_<session_id>.jsonl
```

**Estrutura de log:**
```json
{
  "timestamp": "2025-11-07T10:30:00",
  "session_id": "abc123",
  "user_input": "Como funciona o processo seletivo?",
  "agent_called": "knowledge_agent",
  "tool_used": "get_specific_info",
  "response_time_ms": 1234,
  "emotion_detected": "curious"
}
```

### 2.7.2. Modo Debug

O modo debug est√° **implementado** e pode ser usado com qualquer modo de execu√ß√£o:

```bash
# Debug no modo simple
python3 -m agent_flow.app --mode simple --debug

# Debug no modo demo
python3 -m agent_flow.app --mode demo --debug

# Debug no modo full
python3 -m agent_flow.app --mode full --debug
```

**Informa√ß√µes mostradas:**
- Tamanho do hist√≥rico de mensagens
- Traces completos de exce√ß√µes
- Tempo de processamento
- Metadata de cada intera√ß√£o

**Exemplo de output com debug:**

```
üîß Mode: SIMPLE (Direct API calls)
üìç Model: gemini-2.0-flash-exp
üêõ Debug: ENABLED
------------------------------------------------------------

üë§ Voc√™: Como funciona o processo seletivo?

[DEBUG] History length: 1 messages
[DEBUG] Processing input...
[DEBUG] Response generated

üêï Robot Dog: [latido] √ìtima pergunta!...

[DEBUG] Message 1/5 completed
```

### 2.7.3. Testar Componentes Isolados

**Testar personality tools:**

```python
from agent_flow.tools.personality_tools import detect_visitor_emotion

class MockContext:
    def __init__(self):
        self.state = {}

context = MockContext()
result = detect_visitor_emotion("Estou muito empolgado!", context)
print(result)
# Output: {'emotion': 'excited', 'confidence': 0.85, ...}
```

**Testar knowledge search:**

```python
from agent_flow.agents.knowledge_agent import search_inteli_knowledge

class MockContext:
    def __init__(self):
        self.state = {}

context = MockContext()
result = search_inteli_knowledge("bolsas", context, top_k=3)
print(result['documents'])
```

## 2.8. Boas Pr√°ticas

### 2.8.1. Perguntas Efetivas

**Use palavras-chave diretas:**
- "processo seletivo" (melhor que "como entrar")
- "bolsas" (melhor que "aux√≠lio financeiro")
- "clubes" (melhor que "atividades extracurriculares")

**Seja espec√≠fico:**
- "Quantos cursos tem?" (melhor que "Me fale sobre o Inteli")
- "Como funciona o PBL?" (melhor que "Como s√£o as aulas?")

### 2.8.2. Gest√£o de API Quotas

**Monitorar uso:**
```bash
# Verificar quantas chamadas foram feitas
grep "API call" logs/*.log | wc -l
```

**Otimizar prompts:**
- Evitar prompts muito longos
- Limitar hist√≥rico de conversa (√∫ltimas 10 mensagens)
- Usar temperature baixa para respostas consistentes

## 2.9. Comandos √öteis

### 2.9.1. Visualiza√ß√£o de Estrutura

```bash
# Ver estrutura do projeto
tree -L 3 -I 'venv|__pycache__|*.pyc'

# Contar linhas de c√≥digo
find agent_flow -name "*.py" | xargs wc -l
```

### 2.9.2. Limpeza

```bash
# Remover cache Python
find . -type d -name "__pycache__" -exec rm -r {} +
find . -type f -name "*.pyc" -delete

# Remover logs (quando implementado)
rm -rf logs/*.jsonl
```

## 2.10. Refer√™ncias R√°pidas

### 2.10.1. Comandos Essenciais

| Comando | Descri√ß√£o | Quando Usar |
|---------|-----------|-------------|
| `python3 -m agent_flow.app` | Modo full (padr√£o) | Uso normal do sistema |
| `python3 -m agent_flow.app --mode demo` | Demo automatizado | Apresenta√ß√µes |
| `python3 -m agent_flow.app --mode simple` | Vers√£o simplificada | Debug e desenvolvimento |
| `python3 -m agent_flow.app --debug` | Ativa logs debug | Troubleshooting |
| `python3 -m agent_flow.app --help` | Ajuda completa | Ver todas as op√ß√µes |
| `python test_agent_flow.py` | Valida√ß√£o completa | Antes de commits |
| `python preprocess_pdf.py` | Gerar chunks | Setup inicial |

### 2.10.2. Arquivos Principais

| Arquivo | Prop√≥sito | Modificar Para |
|---------|-----------|----------------|
| `agent_flow/app.py` | **Entry point principal** | Execu√ß√£o do sistema |
| `test_agent_flow.py` | Suite de testes | Valida√ß√£o antes de commits |
| `preprocess_pdf.py` | Processamento de PDFs | Gerar chunks RAG |
| `.env` | Configura√ß√µes | API keys e modelos |

### 2.10.3. Diret√≥rios Importantes

| Diret√≥rio | Conte√∫do | Modificar Para |
|-----------|----------|----------------|
| `agent_flow/agents/` | Agentes | Mudar comportamento |
| `agent_flow/tools/` | Ferramentas | Adicionar funcionalidades |
| `agent_flow/prompts/` | Guidelines | Ajustar personalidade |
| `documents/` | Dados RAG | Expandir base de conhecimento |
| `docs/` | Documenta√ß√£o | Guias e arquitetura |

### 2.10.4. Flags e Op√ß√µes

```bash
# Ver todas as flags dispon√≠veis
python3 -m agent_flow.app --help

# Combina√ß√µes √∫teis
python3 -m agent_flow.app --mode demo --model gemini-2.0-flash
python3 -m agent_flow.app --mode simple --debug
python3 -m agent_flow.app --mode full --model gemini-2.0-flash-exp
```

### 2.10.5. Links √öteis

- **Gemini API Docs:** [https://ai.google.dev/](https://ai.google.dev/)
- **Google ADK:** [https://google.github.io/adk-toolkit/](https://google.github.io/adk-toolkit/)
- **API Console:** [https://console.cloud.google.com/](https://console.cloud.google.com/)
- **Reposit√≥rio:** [https://github.com/daviiabreu/embedding-models](https://github.com/daviiabreu/embedding-models)
